diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/android/Kbuild cm12.1/android/Kbuild
--- org_cm12.1/android/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/android/Kbuild	2015-10-07 22:14:51.951111754 +0200
@@ -0,0 +1,17 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+libs-y                          += libc/
+libs-y                          += librpc/
+libs-y                          += regex/
+libs-y                          += selinux/
+
+
+lib-y:=
+
+lib-y  += android.o
+lib-y  += reboot.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/android/libc/Kbuild cm12.1/android/libc/Kbuild
--- org_cm12.1/android/libc/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/android/libc/Kbuild	2015-10-07 22:15:17.479111163 +0200
@@ -0,0 +1,14 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+lib-y:=
+
+mktemp.c  pty.c  __set_errno.c
+
+lib-y  += mktemp.o
+lib-y  += pty.o
+lib-y  += __set_errno.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/android/librpc/Kbuild cm12.1/android/librpc/Kbuild
--- org_cm12.1/android/librpc/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/android/librpc/Kbuild	2015-10-07 22:15:26.579110952 +0200
@@ -0,0 +1,52 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+lib-y:=
+
+lib-y += pm_getmaps.o
+lib-y += rpc_thread.o
+lib-y += clnt_udp.o
+lib-y += clnt_perror.o
+lib-y += clnt_simple.o
+lib-y += auth_unix.o
+lib-y += xdr_stdio.o
+lib-y += pmap_prot.o
+lib-y += xdr_rec.o
+lib-y += svc_authux.o
+lib-y += pmap_clnt.o
+lib-y += xdr_reference.o
+lib-y += rpc_prot.o
+lib-y += rpc_dtablesize.o
+lib-y += bindresvport.o
+lib-y += rpc_cmsg.o
+lib-y += svc.o
+lib-y += pm_getport.o
+lib-y += svc_udp.o
+lib-y += rpc_commondata.o
+lib-y += xdr.o
+lib-y += svc_run.o
+lib-y += auth_none.o
+lib-y += svc_tcp.o
+lib-y += xdr_float.o
+lib-y += clnt_raw.o
+lib-y += authunix_prot.o
+lib-y += pmap_prot2.o
+lib-y += clnt_tcp.o
+lib-y += xdr_intXX_t.o
+lib-y += pmap_rmt.o
+lib-y += clnt_unix.o
+lib-y += xdr_mem.o
+lib-y += getrpcent.o
+lib-y += get_myaddress.o
+lib-y += svc_simple.o
+lib-y += svc_unix.o
+lib-y += getrpcport.o
+lib-y += create_xid.o
+lib-y += svc_auth.o
+lib-y += clnt_generic.o
+lib-y += xdr_array.o
+lib-y += svc_raw.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/android/regex/Kbuild cm12.1/android/regex/Kbuild
--- org_cm12.1/android/regex/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/android/regex/Kbuild	2015-10-07 22:15:44.200261907 +0200
@@ -0,0 +1,10 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+lib-y:=
+
+lib-y += bb_regex.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/android/selinux/Kbuild cm12.1/android/selinux/Kbuild
--- org_cm12.1/android/selinux/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/android/selinux/Kbuild	2015-10-07 22:15:59.292261557 +0200
@@ -0,0 +1,11 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+lib-y:=
+
+lib-y += matchpathcon.o
+lib-y += stubs.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/extra_includes/cutils/android_reboot.h cm12.1/extra_includes/cutils/android_reboot.h
--- org_cm12.1/extra_includes/cutils/android_reboot.h	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/extra_includes/cutils/android_reboot.h	2015-10-07 22:16:22.152261028 +0200
@@ -0,0 +1,39 @@
+/*
+ * Copyright 2011, The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+#ifndef __CUTILS_ANDROID_REBOOT_H__
+#define __CUTILS_ANDROID_REBOOT_H__
+
+#include <mntent.h>
+
+__BEGIN_DECLS
+
+/* Commands */
+#define ANDROID_RB_RESTART  0xDEAD0001
+#define ANDROID_RB_POWEROFF 0xDEAD0002
+#define ANDROID_RB_RESTART2 0xDEAD0003
+
+/* Properties */
+#define ANDROID_RB_PROPERTY "sys.powerctl"
+
+int android_reboot(int cmd, int flags, const char *arg);
+int android_reboot_with_callback(
+    int cmd, int flags, const char *arg,
+    void (*cb_on_remount)(const struct mntent*));
+
+__END_DECLS
+
+#endif /* __CUTILS_ANDROID_REBOOT_H__ */
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/include/libbb.h cm12.1/include/libbb.h
--- org_cm12.1/include/libbb.h	2015-10-07 22:06:56.204123905 +0200
+++ cm12.1/include/libbb.h	2015-10-07 22:23:03.164481818 +0200
@@ -1985,4 +1985,8 @@
 
 POP_SAVED_FUNCTION_VISIBILITY
 
+#ifndef CONFIG_DEFAULT_MODULES_DIR
+#define CONFIG_DEFAULT_MODULES_DIR "/system/lib/modules"
+#endif
+
 #endif
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/libworkaround/Kbuild cm12.1/libworkaround/Kbuild
--- org_cm12.1/libworkaround/Kbuild	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/libworkaround/Kbuild	2015-10-07 22:16:34.719116748 +0200
@@ -0,0 +1,10 @@
+# DO NOT EDIT. This file is generated from Kbuild.src
+# Makefile for busybox
+#
+# Copyright (C) 1999-2005 by Erik Andersen <andersen@codepoet.org>
+#
+# Licensed under GPLv2, see file LICENSE in this source tree.
+
+lib-y:=
+
+lib-y  += libworkaround.o
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/libworkaround/libworkaround.c cm12.1/libworkaround/libworkaround.c
--- org_cm12.1/libworkaround/libworkaround.c	1970-01-01 01:00:00.000000000 +0100
+++ cm12.1/libworkaround/libworkaround.c	2015-10-07 22:16:34.719116748 +0200
@@ -0,0 +1,9 @@
+# include <sys/types.h> /* size_t */
+# include <stdio.h> /* for FILE */
+
+char* bb_ttyname(int x) {}
+int   bb_ttyname_r(int x, char *ptr, size_t s) {}
+char *bb_mktemp(char *ptr) {}
+
+ssize_t getline(char **lineptr, size_t *n, FILE *stream) {}
+
diff -Nur -x.git -xdocs -xbusybox-mcbane87.config org_cm12.1/Makefile cm12.1/Makefile
--- org_cm12.1/Makefile	2015-10-07 22:06:56.024123910 +0200
+++ cm12.1/Makefile	2015-10-07 22:19:22.527948927 +0200
@@ -4,12 +4,6 @@
 EXTRAVERSION =
 NAME = bionic
 
-# prevent local tree builds in bionic,
-# but allow initial version check (SUBMAKE)
-ifeq (,$(filter s, $(MAKEFLAGS)))
-    KBUILD_OUTPUT ?= $(OUT)/obj/busybox
-endif
-
 # *DOCUMENTATION*
 # To see a list of typical targets execute "make help"
 # More info can be located in ./README
@@ -471,6 +465,7 @@
 		applets/ \
 
 libs-y		:= \
+		android/ \
 		archival/ \
 		archival/libarchive/ \
 		console-tools/ \
@@ -483,6 +478,7 @@
 		init/ \
 		libbb/ \
 		libpwdgrp/ \
+		libworkaround/ \
 		loginutils/ \
 		mailutils/ \
 		miscutils/ \
